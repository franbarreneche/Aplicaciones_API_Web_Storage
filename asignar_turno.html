<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Asignar Turno</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.0/css/bulma.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css" integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
</head>

<body>
    <!-- START NAV -->
    <nav class="navbar is-white">
        <div class="container">
            <div class="navbar-brand">
                <a class="navbar-item brand-text" href="index.html">CellWORLD </a>
                <div class="navbar-burger burger" data-target="navMenu">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
            <div id="navMenu" class="navbar-menu">
                <div class="navbar-start">
                    <a class="navbar-item" href="login.html">
                        Login
                    </a>
                    <a class="navbar-item" href="asignar_turno.html">
                        Asignar Turno
                    </a>
                    <a class="navbar-item" href="atencion_cliente.html">
                        Atención Cliente
                    </a>
                </div>

            </div>
        </div>
    </nav>
    <!-- END NAV -->

    <section class="section">
        <div class="container">
            <div class="column is-12">
                <nav class="breadcrumb" aria-label="breadcrumbs">
                    <ul>
                        <li><a href="#">Turneitor</a></li>
                        <li class="is-active"><a href="#" aria-current="page">Asignar Turno</a></li>
                    </ul>
                </nav>
                <section class="hero is-info welcome is-small">
                    <div class="hero-body">
                        <div class="container">
                            <h1 class="title">
                                Hola, <span id="nombreUsuario"></span>
                            </h1>
                            <h2 class="subtitle">
                                ingresá a los clientes que entren al local.
                            </h2>
                        </div>
                    </div>
                </section>
                <section class="section">
                    <div class="columns">
                        <div class="column is-6">
                            <div class="card">
                                <header class="card-header">
                                    <p class="card-header-title">
                                        Códigos de Turnos
                                    </p>
                                    <a href="#" class="card-header-icon" aria-label="more options">
                                        <span class="icon">
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        </span>
                                    </a>
                                </header>
                                <div class="card-content">
                                    <ul>
                                        <li><span class="tag is-primary"><span
                                                    class="has-text-weight-bold">RE</span>XX</span><span
                                                class="is-size-5 has-text-grey"> Reparación de Equipos</span></li>
                                        <li><span class="tag is-success"><span
                                                    class="has-text-weight-bold">CE</span>XX</span><span
                                                class="is-size-5 has-text-grey"> Compra de Equipos</span></li>
                                        <li><span class="tag is-info"><span
                                                    class="has-text-weight-bold">RR</span>XX</span><span
                                                class="is-size-5 has-text-grey"> Retiro de Reparaciones</span></li>
                                        <li><span class="tag is-dark"><span
                                                    class="has-text-weight-bold">AC</span>XX</span><span
                                                class="is-size-5 has-text-grey"> Atención al Cliente</span></li>
                                        <li><span class="tag is-danger"><span
                                                    class="has-text-weight-bold">QQ</span>XX</span><span
                                                class="is-size-5 has-text-grey"> Quejas</span></li>
                                        </ul>
                                </div>
                            </div>                            
                            <div class="field">
                                <p class="control has-icons-left has-icons-right">
                                    <input id="textNombre" class="input is-medium" type="text" placeholder="Nombre" required>
                                    <span class="icon is-small is-left">
                                        <i class="fas fa-user"></i>
                                    </span>
                                    <span class="icon is-small is-right">
                                        <i class="fas fa-check"></i>
                                    </span>
                                </p>
                            </div>
                            <div class="field">
                                <div class="control">
                                    <div class="select is-medium">
                                        <select id="selectCodigo">
                                            <option>RE | Reparación de Equipos</option>
                                            <option>CE | Compra de Equipos</option>
                                            <option>RR | Retiro de Reparaciones</option>
                                            <option>AC | Atención al Cliente</option>
                                            <option>QQ | Quejas</option>
                                        </select>
                                    </div>

                                </div>                                
                            </div>
                            <div class="field">
                                <p class="control">
                                    <button class="button is-success" id="botonAgregarCliente">
                                        Agregar
                                    </button>
                                </p>
                            </div>
                        </div>
                        <div class="column is-6">
                            <div class="card">
                                <header class="card-header">
                                    <p class="card-header-title">
                                        Personas sin Atender
                                    </p>
                                    <a href="#" class="card-header-icon" aria-label="more options">
                                        <span class="icon">
                                            <i class="fa fa-angle-down" aria-hidden="true"></i>
                                        </span>
                                    </a>
                                </header>
                                <div class="card-content">
                                    <div class="table-container">
                                        <table id="sinAtender" class="table is-fullwidth is-striped"> 
                                        <tr>
                                            <th>Nombre</th>
                                            <th>Turno</th>
                                        </tr>                                       
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        </div>
        </div>
    </section>


    <!-- SCRIPTS MIOS -->
    <script>
        const queryString = location.search;
        const urlParams = new URLSearchParams(queryString);
        const usuario = urlParams.get("usuario");
        console.log(usuario);
        document.getElementById("nombreUsuario").innerHTML = usuario;

        //variable globales de los turnos
        var turnosRE = 0;
        var turnosCE = 0;
        var turnosRR = 0;
        var turnosAC = 0;
        var turnosQQ = 0;

        document.getElementById("botonAgregarCliente").addEventListener("click", function(){
            //obtener y perparar nombre del cliente
            var tabla = document.getElementById("sinAtender");
            var nuevo = document.getElementById("textNombre").value;            
            
            //obtener y preprar turno
            var selectValue = document.getElementById("selectCodigo").value;
            var color = "light";
            if(selectValue.includes('RE')) {
                turnosRE++;
                selectValue = "RE"+turnosRE;
                color = "primary";
            } else if(selectValue.includes("CE")) {
                turnosCE++;
                selectValue = "CE"+turnosCE;
                color = "success";
            } else if(selectValue.includes("RR")) {
                turnosRR++;
                selectValue = "RR"+turnosRR;
                color =  "info";
            } else if(selectValue.includes("AC")) {
                turnosAC++;
                selectValue = "AC"+turnosAC;
                color = "dark";
            }else {
                turnosQQ++;
                selectValue = "QQ"+turnosQQ;
                color = "danger";
            }

            //agregar a la lista html
            var elemNombre  = document.createElement("td");
            elemNombre.innerHTML = nuevo;
            var elemTurno = document.createElement("td");
            elemTurno.innerHTML =  ' <span class="tag is-'+ color +'">' + selectValue + '<span>';
            var elemRow = document.createElement("tr");
            elemRow.appendChild(elemNombre);           
            elemRow.appendChild(elemTurno);
            tabla.appendChild(elemRow);
        });
    </script>

    <!-- OTROS SCRIPTS -->
    <script async type="text/javascript" src="js/bulma.js"></script>
</body>

</html>